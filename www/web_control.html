<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

  <script src="https://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
  <script src="https://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>
  <script src="./roslib.js"></script>

</head>

<body>
    <div class="container mt-4">
        <h1 class="mb-4">ROS Robot Control Interface</h1>
        
        <div class="card">
          <div class="card-header">
            Robot Movement Control (cmd_vel)
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="linear-velocity">Linear Velocity (x-axis): </label>
              <input type="range" class="custom-range" min="-1" max="1" step="0.1" id="linear-velocity" value="0">
            </div>
            <div class="form-group">
              <label for="angular-velocity">Angular Velocity (z-axis): </label>
              <input type="range" class="custom-range" min="-1" max="1" step="0.1" id="angular-velocity" value="0">
            </div>
            <button type="button" id="move-button" class="btn btn-primary">Move Robot</button>
            <button type="button" id="stop-button" class="btn btn-danger ml-2">Emergency Stop</button>
          </div>
        </div>
      </div>
    <script>
        var ros = new ROSLIB.Ros();
        ros.connect('ws://localhost:9090');
    
        var cmd_vel = new ROSLIB.Topic({
            ros : ros,
            name : '/cmd_vel',
            messageType : 'geometry_msgs/Twist'
        });

        function publishTwist(linearVel, angularVel) {
            var twist = new ROSLIB.Message({
                linear : {
                    x : linearVel,
                    y : 0.0,
                    z : 0.0
                },
                angular : {
                    x : 0.0,
                    y : 0.0,
                    z : angularVel
                }
            });

            cmd_vel.publish(twist);
            console.log("Publishing cmd_vel: linear x = " + linearVel + ", angular z = " + angularVel);
            }

        $("#move-button").click(function() {
            var linearVel = parseFloat($("#linear-velocity").val());
            var angularVel = parseFloat($("#angular-velocity").val());
            publishTwist(linearVel, angularVel);
        });

        $("#stop-button").click(function() {
            publishTwist(0, 0);
            console.log("Emergency Stop Activated!");
        });
      </script>
</body>
</html>